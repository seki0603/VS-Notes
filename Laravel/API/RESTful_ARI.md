# Web サイトの通信パターン

## MPA (Multi Page Application)

1. Web サイトを表示するためのリクエストをサーバに送る
2. サーバからレスポンスとして HTML が返ってくる
3. ブラウザで返ってきた HTML を表示する

## SPA (Single Page Application)

1. Web サイトを表示するためのリクエストをサーバに送る
2. サーバからレスポンスとして HTML が返ってくる
3. ブラウザで返ってきた HTML を表示する
4. 2 回目以降は Ajax で差分情報のリクエストをサーバに送る
5. JSON 形式が返ってくる
6. ブラウザで返ってきた差分箇所の JSON を JavaScript で HTML に追加して表示する
   <br>

- Ajax...一部の情報のみをリクエストできる仕組み
- JSON 形式...JavaScript と相性のいいシンプルなフォーマット

# SPA のメリット・デメリット

### メリット

- 通常の Web ページでは実現できない UX を実現できる
  - 表示したまま一部のコンテンツを変更するなど
- 高速なページ遷移を実現できる
- Web アプリとして作成したものをネイティブアプリとして流用できる

### デメリット

- 実装コストの大幅な増加
  - ブラウザが行ってきた履歴管理・URL の割り当て・ローディングの表示を自ら実装する必要がある。
- 初期ローディングにかかる時間が増える
- 開発者が少ない

# SPA の種類

## 完全 SPA

フロントとバックエンドを完全分離

- フロント：React / Vue / Next.js (JavaScript)
- バックエンド：Laravel API (PHP)
  - フロントがバックエンドからデータを JSON でもらう
  - Laravel は JSON を返すだけで画面生成しない

## ライブラリ SPA

- Livewire：DOM 差分・AJAX・PHP
- インナー SPA：Laravel + Turbo / HTMX
- Alpine.js
  - Livewire が非同期通信（AJAX）を裏で走らせる
  - フロント側が API を意識しない

## 完全 SPA とライブラリ SPA の違い

| 項目                 | Livewire（API なし）         | React/Vue（API あり）                 |
| -------------------- | ---------------------------- | ------------------------------------- |
| 画面更新             | PHP → 部分 HTML 返す         | JSON を返しフロント JS がレンダリング |
| 状態管理             | ほぼ Livewire 側が自動       | 開発者が管理（Redux, Zustand 等）     |
| バックエンドとの通信 | Livewire が勝手に POST/GET   | fetch/Axios で API を手で叩く         |
| 学習コスト           | 低い（Laravel 知識の延長）   | 高い（JS/TS と UI 設計が必要）        |
| 目的                 | 社内ツール/CRUD アプリ高速化 | 商用向けの高 UI/大規模アプリ          |
<br>

* React SPA → API を直接叩く
* Livewire SPA → API を内部で自動で叩いている（画面パーツごとに）

# API (Application Programming Interface)

サービスのデータを外部のアプリケーションから扱うための機能を提供するインターフェイス

# RESTful API
RESTと呼ばれる設計原則に従って策定されたAPIの種類の一つ

## RESTの原則
### アドレス可読性
* 提供する情報がURIを通して表現できること
* 全ての情報はURIで表現される一意なアドレスを持っていること

### ステートレス性
* HTTPをベースにしたステートレスなクライアント/サーバプロトコルであること
* セッション等の状態管理はせず、やり取りされる情報はそれ自体で完結して解釈できること

### 接続性
* 情報の内部に、別の情報や(その情報の別の)状態へのリンクを含めることができること

### 統一インターフェイス
* 情報の操作(CRUD処理)は全てHTTPメソッドを利用すること

## RESTful APIを使うメリット
1. URIに規律が生まれることで、APIを利用するサービス開発者が楽になる。
2. URIに規律が生まれることで、API開発者もURIからソースのどの部分なのかが容易にわかる。
3. ブラウザのアドレスバーにURIを入力すればリソースが参照できる。
4. サーバ、クライアント間で何も共有しないことにより、負荷に応じたスケーラビリティが向上する。ステートレス性に値するもので、一番のメリットされている。
5. GET、POST、PUT、DELETE等のHTTP標準のメソッドを使うことで、シンプルで一貫性のあるリクエスト標準化が円滑に行える。統一インターフェースに値する。